# 系统架构设计

## 整体架构

Pulse 采用微服务架构设计，基于 Spring Boot 构建，支持水平扩展和模块化开发。

```
┌─────────────────────────────────────────────────────────────┐
│                        客户端层                              │
├─────────────────────────────────────────────────────────────┤
│                     API网关层                               │
│                   (pulse-gateway)                          │
├─────────────────────────────────────────────────────────────┤
│                      应用服务层                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │pulse-manager│  │ pulse-app   │  │   其他应用   │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
├─────────────────────────────────────────────────────────────┤
│                      业务服务层                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │ pulse-user  │  │pulse-motion │  │  pulse-ai   │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
├─────────────────────────────────────────────────────────────┤
│                      基础服务层                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │pulse-common │  │ pulse-cache │  │ pulse-auth  │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
├─────────────────────────────────────────────────────────────┤
│                      数据存储层                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │    MySQL    │  │    Redis    │  │   文件存储   │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
└─────────────────────────────────────────────────────────────┘
```

## 模块职责

### 基础服务层
- **pulse-common**: 公共组件，提供通用工具类、常量定义、异常处理等
- **pulse-cache**: 缓存服务，封装Redis操作，提供分布式缓存能力
- **pulse-auth**: 认证授权服务，提供JWT认证、权限控制等安全功能
- **pulse-web**: Web组件，提供统一的异常处理、响应格式等

### 业务服务层
- **pulse-user**: 用户服务，负责用户管理、权限路由等功能
- **pulse-motion**: 运动服务，提供运动标签管理、智能餐食推荐等
- **pulse-ai**: AI服务，集成AI能力，提供智能推荐和分析功能

### 应用服务层
- **pulse-app**: 应用服务，提供签到、积分等应用级功能
- **pulse-manager**: 管理服务，提供后台管理功能

## 技术选型

### 后端技术栈
- **框架**: Spring Boot 2.7.4
- **数据访问**: MyBatis + PageHelper
- **数据库**: MySQL 8.0
- **缓存**: Redis + Spring Cache
- **认证**: JWT + Spring Security
- **工具库**: Hutool、Guava
- **HTTP客户端**: OkHttp

### 中间件
- **消息队列**: 待集成 (建议RabbitMQ或RocketMQ)
- **配置中心**: 待集成 (建议Nacos或Apollo)
- **服务注册发现**: 待集成 (建议Nacos或Eureka)
- **API网关**: 待集成 (建议Spring Cloud Gateway)

## 数据流转

```
客户端请求 → API网关 → 应用服务 → 业务服务 → 数据存储
                ↓
            认证授权 ← 基础服务 ← 缓存服务
```

## 部署架构

### 开发环境
- 单机部署
- 内嵌数据库
- 本地缓存

### 生产环境
- 容器化部署 (Docker + Kubernetes)
- 数据库集群
- Redis集群
- 负载均衡
- 监控告警

## 扩展性设计

### 水平扩展
- 无状态服务设计
- 数据库读写分离
- 缓存集群
- 消息队列解耦

### 高可用
- 服务多实例部署
- 数据库主从复制
- 缓存哨兵模式
- 熔断降级机制